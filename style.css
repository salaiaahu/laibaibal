:root {
    /* Backgrounds */
    --main-bg-color: #f4f4f4;
    --panel-bg-color: #ffffff;
    --top-bar-bg-color: #2c3e50;
    --sidebar-bg-color: #34495e;
    --modal-content-bg-color: #fefefe;
    --modal-border-color: #cccccc; /* Slightly more defined border for modal */
    --modal-title-text-color: var(--main-text-color);
    --modal-shadow: 0 5px 15px rgba(0,0,0,0.2);
    --button-bg-color: #4CAF50;
    --button-hover-bg-color: #45a049;
    --button-disabled-bg-color: #9e9e9e;
    --close-button-bg-color: #6c757d;
    --delete-button-bg-color: #dc3545;
    --grid-item-bg-color: #fff; /* Was #e0e0e0 for old chapter grid, now #fff for new professional look */
    --grid-item-selected-bg-color: #4CAF50;

    --input-bg-color: #ffffff; /* Background for textarea */
    --input-text-color: var(--main-text-color);
    --input-border-color: #cccccc;
    --input-focus-border-color: var(--accent-color); /* Use accent color for focus */

    --button-secondary-bg-color: #f0f0f0;
    --button-secondary-text-color: #333333;
    --button-secondary-border-color: #cccccc;
    --button-secondary-hover-bg-color: #e0e0e0;

    --delete-button-bg-color: #dc3545;
    --delete-button-text-color: #ffffff;
    --delete-button-hover-bg-color: #c82333;

    /* Text Colors */
    --main-text-color: #333;
    --panel-text-color: #333;
    --top-bar-text-color: #ffffff;
    --sidebar-text-color: #ffffff;
    --button-text-color: #ffffff;
    --link-color: #007bff;
    --link-hover-color: #0056b3;
    --verse-number-color: #6a0dad;
    --subheading-text-color: #34495e;
    --grid-item-text-color: #333;
    --grid-item-selected-text-color: #ffffff;

    /* Text Size */
    --bible-text-font-size: 1rem;       /* Default base size for verse text */
    --bible-subheading-font-size: 1.2em;  /* Relative to parent's font size */
    --bible-title-font-size: 1.1em;

    /* Borders & Shadows */
    --panel-border-color: #d1d5db; /* Updated to consistent border */
    --grid-item-border-color: #d1d5db;
    --grid-item-hover-border-color: #4CAF50;
    --top-bar-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    --panel-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); /* Subtle shadow */
    --modal-border-color: #888;

    /* Highlight Colors (already good, just ensure they are variables if you want themes to alter them) */
    --highlight-yellow: #fff58c;
    --highlight-green: #b9fbc0;
    --highlight-blue: #a0c4ff;
    --highlight-pink: #ffc6ff;
    --highlight-orange: #ffd6a5;
    /* Add --highlight-purple if you keep it */
    /* --highlight-purple: #bdb2ff; */


    /* Fonts (Optional for now, but good to have) */
    --font-family-main: Arial, sans-serif;
    --font-size-normal: 1rem;
    --line-height-normal: 1.6;
	
	--panel-bg-color: #ffffff;
    --panel-text-color: var(--main-text-color); /* Panels use main text color */
    --panel-border-color: #d1d5db; /* Or #ddd if you prefer */
    --panel-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);

    --bible-column-bg-color: #ffffff; /* Specific background for the bible column */
    --bible-column-border-color: #dddddd;
    --bible-column-text-color: var(--main-text-color); /* Text within the bible column */
    
    --column-title-text-color: #2c3e50;
    --column-title-border-color: #eeeeee;
    
    --verse-number-text-color: #6a0dad; 
    --subheading-text-color: #34495e;
    --subheading-border-color: #eeeeee;

    --accent-color: #4CAF50; 
    --accent-text-color: #ffffff;
    --selected-verse-bg-color: #e6ffe6;
    --selected-verse-text-color: var(--main-text-color);
}
body.theme-dark {
    --main-bg-color: #1e1e1e;
    --main-text-color: #e0e0e0;
    --panel-bg-color: #2a2a2a;
    --panel-border-color: #4a4a4a;
    --panel-shadow: 0 0 15px rgba(0, 0, 0, 0.6);
    --accent-color: #007bff; 
    --accent-text-color: #ffffff;

    --top-bar-bg-color: #121212;
    --top-bar-text-color: #e0e0e0;
    --top-bar-button-bg-color: #007bff; /* Example: Blue buttons in dark mode */
    --top-bar-button-hover-bg-color: #0056b3;

    --sidebar-bg-color: #222222;
    --sidebar-text-color: #d0d0d0;
    --sidebar-hover-bg-color: #333333;
    --sidebar-selected-bg-color: #007bff;
    --sidebar-border-color: #444;

    --button-bg-color: #007bff; /* General buttons */
    --button-hover-bg-color: #0056b3;
    --close-button-bg-color: #555;
    --delete-button-bg-color: #c82333;


    --grid-item-bg-color: #303030;
    --grid-item-text-color: #e0e0e0;
    --grid-item-border-color: #4f4f4f;
    --grid-item-hover-border-color: #007bff;
    --grid-item-hover-text-color: #007bff;
    --grid-item-selected-bg-color: #007bff;
    --grid-item-selected-text-color: #ffffff;

    --verse-number-color: #58a6ff; /* Lighter accent for dark mode */
    --subheading-text-color: #c0c0c0;
    --link-color: #58a6ff;
    --link-hover-color: #82c0ff;

    --modal-content-bg-color: #333333;
    --modal-border-color: #555555;

    /* Adjust highlight colors for better visibility on dark backgrounds */
    --highlight-yellow: #b0a02c; /* Darker, less intense yellow */
    --highlight-green: #3b8056;
    --highlight-blue: #3d70b2;
    --highlight-pink: #a750a7;
    --highlight-orange: #b8783e;

    --panel-bg-color: #2a2a2a;
    --panel-text-color: var(--main-text-color);
    --panel-border-color: #4a4a4a;

    --bible-column-bg-color: #222222;        /* Dark background for bible column */
    --bible-column-border-color: #444444;    /* Darker border */
    --bible-column-text-color: var(--main-text-color); /* Light text for dark mode */

    --column-title-text-color: var(--main-text-color);
    --column-title-border-color: var(--panel-border-color);

    --verse-number-text-color: #82c0ff;      /* Light blue for dark mode verse numbers */
    --subheading-text-color: #c0c0c0;        /* Light grey for subheadings */
    --subheading-border-color: var(--panel-border-color);
    --selected-verse-bg-color: #3a5370;
    --selected-verse-text-color: var(--main-text-color);

    --modal-content-bg-color: #3a3a3a; /* Darker content area */
    --modal-border-color: #555555;
    --main-text-color: #e0e0e0;
    --modal-title-text-color: var(--main-text-color); /* Uses light text from dark theme */
    --modal-shadow: 0 5px 20px rgba(0,0,0,0.4);

    --input-bg-color: #2c2c2c; /* Dark input background */
    --input-text-color: var(--main-text-color);
    --input-border-color: #555555;
    --input-focus-border-color: var(--accent-color); /* e.g., your dark theme's blue accent */

    --button-secondary-bg-color: #4f4f4f;
    --button-secondary-text-color: #e0e0e0;
    --button-secondary-border-color: #666666;
    --button-secondary-hover-bg-color: #5a5a5a;

    --delete-button-bg-color: #d32f2f; /* Slightly adjusted red for dark */
    --delete-button-text-color: #ffffff;
    --delete-button-hover-bg-color: #b71c1c;
}

body.theme-sepia {
    --main-bg-color: #f4e8c1;
    --main-text-color: #5b4636; /* Dark brown */
    --panel-bg-color: #efe5cc;
    --panel-border-color: #d3c5aa;
    --panel-shadow: 0 0 10px rgba(80, 60, 40, 0.15);
    --accent-text-color: #f5f5f5;
    --accent-color: #8d6e63;	

    --top-bar-bg-color: #7a5c43; /* Darker sepia/brown */
    --top-bar-text-color: #f4e8c1; /* Light sepia text */

    --sidebar-bg-color: #8d6e63; /* Muted brown */
    --sidebar-text-color: #f5f5f5;
    --sidebar-hover-bg-color: #a1887f;
    --sidebar-selected-bg-color: #6d4c41; /* Darker brown for selection */
    --sidebar-border-color: #c1b0a2;

    --button-bg-color: #8d6e63;
    --button-hover-bg-color: #6d4c41;
    --button-text-color: #f5f5f5;

    --grid-item-bg-color: #faf0d7;
    --grid-item-text-color: #5b4636;
    --grid-item-border-color: #d3c5aa;
    --grid-item-hover-border-color: #6d4c41;
    --grid-item-hover-text-color: #6d4c41;
    --grid-item-selected-bg-color: #6d4c41;
    --grid-item-selected-text-color: #f5f5f5;

    --verse-number-color: #8c5a39;
    --subheading-text-color: #6a4f4b;
    --link-color: #795548;
    --link-hover-color: #5d4037;

    --modal-content-bg-color: #fdf5e6; /* Creamy */
    --modal-border-color: #d2b48c; /* Tan */

    /* Highlight colors for Sepia */
    --highlight-yellow: #e9ab17; /* More golden */
    --highlight-green: #a7d7a9;
    --highlight-blue: #a0b9de;
    --highlight-pink: #e6a8d7;
    --highlight-orange: #f0c27b;

    --panel-bg-color: #efe5cc;
    --panel-text-color: var(--main-text-color);
    --panel-border-color: #d3c5aa;
    --panel-shadow: 0 0 10px rgba(80, 60, 40, 0.15);

    --bible-column-bg-color: #fdf5e6;        /* Creamy background for sepia bible column */
    --bible-column-border-color: #d3c5aa;    /* Sepia border */
    --bible-column-text-color: var(--main-text-color); /* Use sepia main text */
    
    --column-title-text-color: var(--main-text-color);
    --column-title-border-color: var(--panel-border-color);
    
    --verse-number-text-color: #8c5a39;      /* Brownish for sepia verse numbers */
    --subheading-text-color: #6a4f4b;        /* Darker sepia for subheadings */
    --subheading-border-color: var(--panel-border-color);

    --modal-content-bg-color: #fdf5e6; /* Creamy */
    --modal-border-color: #d2b48c; /* Tan */
    --modal-title-text-color: var(--main-text-color);
    --modal-shadow: 0 5px 15px rgba(80, 60, 40, 0.2);

    --input-bg-color: #faf0d7; /* Lighter sepia for input */
    --input-text-color: var(--main-text-color);
    --input-border-color: #d2b48c;
    --input-focus-border-color: var(--accent-color); /* Your sepia accent */

    --button-secondary-bg-color: #e3d9c0;
    --button-secondary-text-color: var(--main-text-color);
    --button-secondary-border-color: #c1b0a2;
    --button-secondary-hover-bg-color: #d5c9b0;

    --delete-button-bg-color: #c66060; /* Muted red for sepia */
    --delete-button-text-color: #ffffff;
    --delete-button-hover-bg-color: #b04040;
}
#verseImageModal .modal-content {
    max-width: 95%; /* Mobile first */
    width: auto;
    min-width: 300px;
    max-height: 95vh; /* Allow a bit more height */
    overflow-y: auto; /* Crucial: Make the modal content itself scrollable */
    padding: 15px;    /* Reduce padding slightly */
}
@media (min-width: 700px) { /* Wider screens */
    #verseImageModal .modal-content {
        max-width: 680px; /* Allow more width for controls side-by-side with preview */
    }
}
/* Theme selector at the top of the modal */
#verseImageModal div[style*="text-align:center"] { /* Targets the theme selector div */
    margin-bottom: 15px !important;
}
#verseImageModal label[for="verseCardTheme"] {
    margin-right: 8px;
    font-weight: 500;
    color: var(--main-text-color);
    font-size: 0.9rem;
}
#verseImageModal #verseCardTheme.popup-select { /* Ensure it uses popup-select styles */
    padding: 6px 10px;
    font-size: 0.9rem;
    flex-grow: 0; /* Don't let it grow too much */
    min-width: 120px; /* Give it a decent width */
}
#verseImageModal h2 { /* "Shareable Verse Card" title */
    font-size: 1.3rem;
    margin-bottom: 15px;
}
#verseImagePreviewContainer {
    width: 95%;
    max-width: 400px; /* Can be smaller if controls need more space */
    margin-left: auto;
    margin-right: auto;
    aspect-ratio: 16 / 9;
    background-color: var(--main-bg-color); /* Placeholder background */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden; /* Important for html2canvas if rendered element is larger */
    border: 1px dashed var(--input-border-color); /* Keep for clarity */
    padding: 0; /* Remove padding if canvas fills it */
    margin-bottom: 20px;
}
#verseImagePreviewContainer canvas {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    display: block;
}

.verse-card-controls-grid.compact-controls {
    display: grid;
    /* Start with 2 columns, adjust minmax for item width */
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); 
    gap: 10px 12px; /* row-gap column-gap */
    margin-bottom: 20px;
    align-items: end; /* Align items to the end of their grid cell (useful if labels are different heights) */
}

.compact-controls .control-group {
    display: flex;
    flex-direction: column;
    justify-content: flex-end; /* Aligns input to bottom if label heights vary */
}

.compact-controls .control-group label {
    font-size: 0.75rem; /* Smaller labels */
    color: var(--main-text-color);
    opacity: 0.85;
    margin-bottom: 3px; /* Tighter space */
    font-weight: 400; /* Normal weight */
    white-space: nowrap; /* Prevent labels from wrapping */
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Full width control (like footer input) in the compact grid */
.compact-controls .control-group.full-width-control {
    grid-column: 1 / -1; /* Span all columns */
}

/* File input controls - special attention for compactness */
.compact-controls .control-group.file-control label {
    margin-bottom: 2px; /* Very tight */
}
.compact-controls .popup-file-input {
    padding: 4px; /* Make file inputs smaller */
    font-size: 0.8rem; /* Smaller text for file input button */
}
.compact-controls .popup-file-input::file-selector-button { /* Style the button part of file input */
    padding: 2px 6px;
    font-size: 0.75rem;
    margin-right: 5px;
}


/* Inputs and Selects within the compact controls */
.compact-controls .popup-select,
.compact-controls .popup-text-input,
.compact-controls .popup-color-input {
    width: 100%;
    padding: 6px 8px; /* Reduced padding */
    font-size: 0.85rem; /* Smaller font */
    /* ... (border, radius, bg, color, focus from existing .popup-select CSS) ... */
    border: 1px solid var(--input-border-color);
    border-radius: 4px;
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    box-sizing: border-box;
}
.compact-controls .popup-color-input {
    padding: 2px; /* Make color input even smaller */
    height: 34px; /* Align with other inputs */
}

/* Controls Layout */
.verse-card-controls-grid {
    display: grid;
    grid-template-columns: 1fr; /* Stack controls on smallest screens */
    gap: 15px; /* Space between control groups */
    margin-bottom: 20px;
}

@media (min-width: 500px) { /* Two columns for controls on slightly larger screens */
    .verse-card-controls-grid {
        grid-template-columns: 1fr 1fr;
    }
    .verse-card-controls-grid .full-width-control { /* Make footer input span both columns */
        grid-column: 1 / -1;
    }
}

.control-group {
    display: flex;
    flex-direction: column; /* Stack label and input */
}
.control-group label {
    font-size: 0.8rem; /* Smaller labels */
    color: var(--main-text-color);
    opacity: 0.9;
    margin-bottom: 4px;
    font-weight: 500;
}

#verseImageModal div[style*="text-align:center"] { /* Targets the theme selector div */
    margin-bottom: 15px !important; /* Ensure space below theme selector */
}
#verseImageModal label[for="verseCardTheme"] {
    margin-right: 8px;
    font-weight: 500;
    color: var(--main-text-color);
}
#verseImageModal #verseCardTheme { /* The theme select dropdown itself */
    padding: 6px 8px;
    border: 1px solid var(--input-border-color);
    border-radius: 4px;
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    font-size: 0.9rem;
}

/* Styling for inputs and selects within the modal - can reuse general popup styles */
.popup-select,
.popup-text-input,
.popup-color-input,
.popup-file-input {
    width: 100%;
    padding: 8px 10px; /* Consistent padding */
    font-size: 0.9rem;
    border: 1px solid var(--input-border-color);
    border-radius: 4px;
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    box-sizing: border-box;
}
.popup-color-input { padding: 4px; height: 38px; } /* Adjust for color input */
.popup-file-input { padding: 5px; }

.popup-select:focus,
.popup-text-input:focus,
.popup-color-input:focus {
    outline: none;
    border-color: var(--input-focus-border-color);
    box-shadow: 0 0 0 2px var(--accent-color-transparent, rgba(0, 123, 255, 0.2));
}

/* Action Buttons at the bottom */
.verse-card-actions {
    display: grid; /* Use grid for two buttons side-by-side */
    grid-template-columns: 1fr 1fr; /* Equal width */
    gap: 10px;
}

.verse-card-actions .modal-action-button {
    padding: 10px 12px; /* Slightly smaller padding */
    font-size: 0.9rem; /* Slightly smaller text */
    /* flex-grow: 1; /* Not needed if using grid for two columns */
}

@media (min-width: 500px) {
    .verse-card-actions .modal-action-button {
        flex-grow: 0; /* Don't grow on larger screens */
        min-width: 120px;
    }
}

/* Secondary action button style (e.g., for "Copy") */
.modal-action-button.secondary-action {
    background-color: var(--button-secondary-bg-color);
    color: var(--button-secondary-text-color);
    border: 1px solid var(--button-secondary-border-color);
}
.modal-action-button.secondary-action:hover {
    background-color: var(--button-secondary-hover-bg-color);
}

html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
    line-height: 1.6;
    background-color: #f4f4f4;
    color: #333;
	background-color: var(--main-bg-color);
    color: var(--main-text-color);
    font-family: var(--font-family-main);
    line-height: var(--line-height-normal);
}

#app-container {
    display: flex;
    flex-direction: column;
    height: 100%;
}

#top-bar {
    background-color: #2c3e50;
    color: white;
    padding: 0.8rem 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    flex-shrink: 0;
    background-color: var(--top-bar-bg-color);
    color: var(--top-bar-text-color);
    box-shadow: var(--top-bar-shadow);
}

.top-group {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 1;           /* Allow groups to shrink */
    flex-grow: 1; 
}

.version-select,
#commentarySelect, /* Added commentarySelect */
#versionNameInput,
#addVersionBtn {
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 0.9rem;
}

.version-select, #commentarySelect {
    background-color: #fff;
    color: #333;
    min-width: 120px;
}

.nav-btn,
#toggleViewBtn,
#toggleSearchBtn,
#toggleFileUploadBtn,
#toggleCommentaryUploadBtn, /* Added commentary button */
#toggleUserDataBtn { /* Added user data button */
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 1px 2px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: background-color 0.2s ease;
}

.nav-btn:hover:not(:disabled),
#toggleViewBtn:hover:not(:disabled),
#toggleSearchBtn:hover:not(:disabled),
#toggleFileUploadBtn:hover:not(:disabled),
#toggleCommentaryUploadBtn:hover:not(:disabled),
#toggleUserDataBtn:hover:not(:disabled) {
    background-color: #45a049;
}

.nav-btn:disabled,
#toggleViewBtn:disabled,
#toggleSearchBtn:disabled,
#toggleFileUploadBtn:disabled,
#toggleCommentaryUploadBtn:disabled,
#toggleUserDataBtn:disabled {
    background-color: #9e9e9e;
    cursor: not-allowed;
}

#toggleFileUploadBtn {
    background-color: #6c757d;
}
#toggleFileUploadBtn:hover {
    background-color: #5a6268;
}

#toggleCommentaryUploadBtn {
    background-color: #8a2be2; /* Blue-violet for commentary */
}
#toggleCommentaryUploadBtn:hover {
    background-color: #6a0dad; /* Darker blue-violet on hover */
}

#toggleUserDataBtn { /* User data button color */
    background-color: #007bff;
}
#toggleUserDataBtn:hover {
    background-color: #0056b3;
}


.chapter-display {
    font-size: 1.2rem;
    font-weight: bold;
    min-width: 80px;
    text-align: center;
}


#main-content-area {
    display: flex;
    flex-grow: 1;
    overflow: hidden;
}

#sidebar {
 /*   width: 200px;
    background-color: #34495e;
    color: white;
    padding: 1rem;
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    overflow-y: auto;
    flex-shrink: 0;
    transition: width 0.3s ease, padding 0.3s ease; */
	display: none;
}

#sidebar.hidden {
    width: 0;
    padding: 0;
    overflow: hidden;
}
/* Make current chapter display clickable */
#currentChapterDisplay {
    cursor: pointer;
    padding: 5px 10px; /* Add some padding to make it a better click target */
    border-radius: 4px;
    transition: background-color 0.2s ease;
}

#currentChapterDisplay:hover {
    background-color: rgba(255, 255, 255, 0.1); /* Subtle hover effect */
}

/* Styles for the new Book/Chapter/Verse Navigator Panel */
#bookChapterVerseSelector {
    /* Ensure it can take up significant space, maybe like a modal */
    position: fixed; /* Or absolute if main-content-area is relative */
    top: 60px; /* Below top-bar */
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 800px; /* Adjust as needed */
    height: calc(100vh - 80px - 40px); 
    max-height: 700px;
    overflow-y: auto;
    z-index: 200; /* Make sure it's above other content but below modals if any */
    /* display: flex; /* Already a panel, which is flex column */
    /* flex-direction: column; */
}

.navigation-view {
    width: 100%;
    display: flex; /* Ensure it's flex column to manage children */
    flex-direction: column;
    flex-grow: 1; /* Allow it to grow if panel is flex */
}

#bookGridContainer {
    display: flex;
    flex-direction: column; /* OT and NT sections will stack */
    gap: 20px; /* Space between OT and NT sections */
    overflow-y: auto; /* Allow internal scrolling if content overflows */
    flex-grow: 1;
}

.testament-section {
    /* border: 1px solid #eee; */
    /* border-radius: 4px; */
    /* padding: 10px; */
}

.testament-section h3 {
    text-align: left;
    margin-top: 0;
    margin-bottom: 10px;
    color: #2c3e50;
    padding-bottom: 5px;
    border-bottom: 1px solid #ddd;
}

/* Styling for book items, chapter items, verse items in their respective grids */
.book-grid .grid-item,
.chapter-grid .grid-item,
.verse-grid .grid-item { 
    background-color: var(--grid-item-bg-color);
    color: var(--grid-item-text-color);
    border: 1px solid var(--grid-item-border-color);
    border-radius: 6px; 
    padding: 8px;
    text-align: center;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    user-select: none;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
}

.book-grid .grid-item:hover,
.chapter-grid .grid-item:hover,
.verse-grid .grid-item:hover {
    border-color: var(--grid-item-hover-border-color);
    color: var(--grid-item-hover-text-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

#chapterGrid.grid-items {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(60px, 1fr)); 
    gap: 10px;
    padding: 10px; 
    overflow-y: auto;
    flex-grow: 1; 
    min-height: 0; 
    grid-auto-rows: min-content;
    align-content: start; 
}
.chapter-grid .grid-item {
    background-color: #fff;
    color: #333;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    text-align: center;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    user-select: none;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80px; 
    padding: 8px; 
    box-sizing: border-box; 
}

.chapter-grid .grid-item:hover {
    border-color: #4CAF50;
    color: #4CAF50;
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

.chapter-number {
    font-size: 1.3em; /* Slightly adjusted for potentially smaller button height */
    display: block;
    line-height: 1.1; /* Tighter line height */
}

.verse-count {
    font-size: 0.7em;
    color: #6b7280; /* Tailwind gray-500 */
    margin-top: 5px; /* Small gap from chapter number */
    display: block;
}

#verseGrid.grid-items { /* If #verseGrid is the element with class .grid-items */
    display: grid;
    /* You can adjust minmax for verse numbers, they might fit in smaller buttons */
    grid-template-columns: repeat(auto-fit, minmax(50px, 1fr)); 
    gap: 8px; /* Slightly smaller gap can look good for verse numbers */
    padding: 10px;
    overflow-y: auto;   /* Allows scrolling if many verses */
    flex-grow: 1;       /* Allows the grid area to use available space if needed */
    min-height: 0;      /* Important for flex children scrolling */
    
    /* --- KEY FIXES for the container --- */
    grid-auto-rows: min-content; /* Rows will be as tall as their content (the verse button height) */
    align-content: start;       /* Packs rows to the start (top) if container is taller */
}

/* This is for the individual verse "buttons" */

#verseGrid .grid-item {
    background-color: #fff;
    color: #333;
    border: 1px solid #d1d5db; /* Using the Tailwind gray-300 like before */
    border-radius: 6px;
    text-align: center;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    user-select: none;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);

    display: flex;          /* For vertical centering of the verse number */
    align-items: center;
    justify-content: center;
    
    height: 50px;           /* <<< SET AN EXPLICIT, SHORTER HEIGHT for verse buttons */
                            /* Adjust (e.g., 40px, 60px) as you see fit */
    padding: 5px;           /* Adjust padding for the new height */
    box-sizing: border-box; /* Include padding & border in the height/width calculation */
    font-size: 0.9em;       /* Verse numbers can often be a bit smaller */
}

#verseGrid .grid-item:hover {
    border-color: #4CAF50; /* Consistent green border on hover */
    color: #4CAF50;
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

/* If a verse item is selected (you have .selected-verse for the reader view,
   you might want a similar .selected class for the grid if needed) */
#verseGrid .grid-item.selected {
    background-color: #4CAF50;
    color: white;
    border-color: #3e8e41;
}
.nav-btn { /* General style for nav buttons in this panel if needed */
     background-color: #6c757d; /* Consistent with other close buttons */
     color: white;
}
.nav-btn:hover {
    background-color: #5a6268;
}
.book-list ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.book-list li {
    padding: 8px 0;
    cursor: pointer;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    transition: background-color 0.2s ease;
}

.book-list li:last-child {
    border-bottom: none;
}

.book-list li:hover {
    background-color: #4a6582;
}

.book-list li.selected {
    background-color: #4CAF50;
    font-weight: bold;
}

#reader-view {
    flex-grow: 1;
    padding: 0;;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow: hidden;
    min-height: 0;
}
#reader-view:not(.reader-active) {
    padding: 0.5rem;
}

.panel {
    background: var(--panel-bg-color); /* CHANGED */
    color: var(--panel-text-color);    /* ADDED */
    box-shadow: var(--panel-shadow);
    padding: 10px;
    width: 100%;

    display: flex;
    flex-direction: column;
    flex-grow: 1;
    overflow: hidden;
    min-height: 0;
    border: 1px solid var(--panel-border-color); /* CHANGED/ADDED */
}

#bibleContentView {
	padding: 5px;

}
/* Main Search Panel - Make it a flex container */
#search-panel {
    /* display: flex; flex-direction: column; /* This is already set by the .panel class, which is good. */
    padding: 20px 25px;
    gap: 15px; /* Add a gap between child elements (controls, status, results, close button) */
}

/* The top section with search inputs and buttons */
.search-controls {
    display: flex;
    flex-wrap: wrap; /* Allow controls to wrap on narrow screens */
    gap: 10px;
    align-items: center;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--panel-border-color); /* Add a separator */
    flex-shrink: 0; /* <<< KEY: Prevent this container from shrinking */
}

/* Style the inputs and selects within the search bar for a professional look */
.search-controls input[type="text"],
.search-controls select {
    padding: 8px 12px;
    border: 1px solid var(--input-border-color);
    border-radius: 5px;
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    font-size: 0.9rem;
    flex-grow: 1; /* Allow input field to take up most space */
    min-width: 150px; /* Give a sensible minimum width */
}
.search-controls select {
    flex-grow: 0; /* Don't let selects grow as much as the text input */
}

/* Style the main search button */
.search-controls #performSearchBtn {
    background-color: var(--accent-color);
    color: var(--accent-text-color);
    border: none;
    padding: 8px 18px;
    border-radius: 5px;
    font-weight: 500;
    cursor: pointer;
    transition: opacity 0.2s ease;
}
.search-controls #performSearchBtn:hover {
    opacity: 0.85;
}


/* The results list container */
#searchResultsList {
    flex-grow: 1;         /* <<< KEY: Make this container take all available vertical space */
    overflow-y: auto;     /* <<< KEY: Make it scrollable if content overflows */
    min-height: 0;        /* Required for flex-grow and overflow to work correctly */
    background-color: var(--main-bg-color); /* A slightly different background for the scroll area */
    border-radius: 5px;
    padding: 10px;
}
	.items-grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Increased min item width for better spacing */
    gap: 10px;
    padding: 10px 0; /* Add some vertical padding */
    margin-top: 10px;
    width: 100%;
    box-sizing: border-box;
}
/* Styling for each individual search result item to make them distinct */
.search-result-item {
    background-color: var(--panel-bg-color); /* Match panel bg for cards */
    padding: 15px;
    margin-bottom: 10px; /* Space between result cards */
    border: 1px solid var(--panel-border-color);
    border-radius: 6px;
    box-shadow: var(--panel-shadow);
    cursor: pointer;
    transition: border-color 0.2s ease, transform 0.2s ease;
}
.search-result-item:hover {
    transform: translateY(-2px);
    border-left: 3px solid var(--accent-color);
    padding-left: 12px; /* Adjust padding to account for new border */
}

/* Style the verse reference part of the result */
.search-result-item .result-reference {
    display: block;
    font-weight: bold;
    font-size: 0.9em;
    color: var(--main-text-color); /* Use a theme variable */
    opacity: 0.8;
    margin-bottom: 5px;
}

/* Style the verse text part of the result */
.search-result-item .result-text {
    line-height: 1.5;
    color: var(--main-text-color); /* Use a theme variable */
}

/* This is for highlighting the matched search words */
.search-result-item em {
    font-style: normal; /* Removes italics from default <em> */
    font-weight: bold;
    background-color: var(--highlight-yellow); /* Use your highlight color */
    color: #000; /* Ensure text is readable on highlight background */
    padding: 1px 3px;
    border-radius: 3px;
}

#upload-panel h3, #commentary-upload-panel h3 { /* "Loaded Versions:" heading */
    font-size: 1.2em;
    color: var(--subheading-text-color); /* Use subheading theme color */
    margin-top: 25px; /* Space above the grid */
    margin-bottom: 10px;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--panel-border-color);
    text-align: left; /* Override panel's center align if any */
}

#upload-panel, #commentary-upload-panel, #search-panel, #user-data-panel { /* Common styles for these panels */
    display: flex; /* keep */
    flex-direction: column; /* keep */
    overflow-y: auto; 
    max-height: calc(100vh - 80px);
}

#upload-panel input[type="file"],
#upload-panel input[type="text"],
#addVersionBtn,
#commentary-upload-panel input[type="file"], /* Added commentary panel inputs */
#commentary-upload-panel input[type="text"],
#addCommentaryBtn {
    width: auto;
    margin-bottom: 10px;
	    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

#loadedVersionsList, #loadedCommentariesList, #highlightsList, #notesList, #bookmarksList { /* Common list styles */
    list-style: none;
    padding: 0;
    margin: 20px 0;
    text-align: left;
}

#loadedVersionsList li, #loadedCommentariesList li {
    background-color: #f0f0f0;
    padding: 8px 12px;
    margin-bottom: 5px;
    border-radius: 4px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#loadedVersionsList li button, #loadedCommentariesList li button {
    background-color: #dc3545;
    padding: 5px 10px;
    font-size: 0.8rem;
}

#loadedVersionsList li button:hover, #loadedCommentariesList li button:hover {
    background-color: #c82333;
}

#closeUploadPanelBtn, #closeCommentaryUploadBtn, #closeSearchPanelBtn, #closeUserDataPanelBtn {
    background-color: var(--accent-color);
    margin-top: 15px;
	width: 60px;
	align-items: center;
	    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
	color: var(--accent-text-color);
}

#closeUploadPanelBtn:hover, #closeCommentaryUploadBtn:hover, #closeSearchPanelBtn:hover, #closeUserDataPanelBtn:hover {
    background-color: #5a6268;
}

.message {
    margin-top: 10px;
    padding: 10px;
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
    border-radius: 4px;
    width: 100%;
}

.message.error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

/* Grid Styles for Chapters/Verses */
.grid-container {
    padding: 20px;
    margin-top: 20px;
    border: 1px solid #ddd;
    border-radius: 5px;
    background-color: #fff;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
}

.grid-items {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
    gap: 10px;
    padding: 10px 0;
    overflow-y: auto;
    flex-grow: 1;
    min-height: 0;
}

.grid-item {
    background-color: #e0e0e0;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 10px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.1s ease;
    user-select: none;
}

.grid-item:hover {
    background-color: #d0d0d0;
    transform: translateY(-2px);
}

.grid-item.selected {
    background-color: #4CAF50;
    color: white;
    border-color: #4CAF50;
}


/* Parallel View Specific Styles */
.parallel-container {
    display: flex;
    gap: 5px;
    width: 100%;
    flex-grow: 1;
    min-height: 0;
}

.bible-column {
    flex: 1;
    border: 1px solid var(--bible-column-border-color);    /* CHANGED */
    border-radius: 5px;
    background-color: var(--bible-column-bg-color);       /* CHANGED */
    padding: 10px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    min-height: 0;
    color: var(--bible-column-text-color); /* ADDED - default text color for content within the column */
}

.column-title { /* e.g., "NIV: Gen 1" */
	font-size: var(--bible-title-font-size);
    text-align: center;
    margin-top: 0;
    margin-bottom: 1px;
    color: var(--column-title-text-color);               /* CHANGED */
    padding-bottom: 1px;
    border-bottom: 1px solid var(--column-title-border-color); /* CHANGED */
    flex-shrink: 0;
}

.bible-content {
    min-height: auto;
    overflow-y: scroll;
    flex-grow: 1;
    min-height: 0;
    -ms-overflow-style: none;
    scrollbar-width: none;
}

.bible-content::-webkit-scrollbar {
    display: none;
}


/* Single View Mode */
.single-view .secondary-column {
    display: none;
}

.single-view .primary-column {
    flex: 1;
}


.bible-content p {
    margin-bottom: 0.5em;
}
.bible-content p.verse-paragraph {
	font-size: var(--bible-text-font-size);
}

.verse-paragraph.selected-verse {
    background-color: var(--selected-verse-bg-color);
    color: var(--selected-verse-text-color); 
    border-left: 3px solid var(--accent-color);
    padding-left: 10px;
    margin-left: -10px;
}

.bible-content .verse-number {
    font-weight: bold;
    margin-right: 5px;
    color: var(--verse-number-text-color); 
}

.commentary-link {
    color: var(--link-color);
    font-weight: bold;
    font-size: 0.8em;
    margin-left: 5px;
    cursor: pointer;
    text-decoration: underline;
    vertical-align: super;
    padding: 1px 3px;
    border: 1px solid var(--link-color);
    border-radius: 3px;
    transition: background-color 0.2s ease, color 0.2s ease;
}

.commentary-link:hover {
    background-color: var(--link-color);
    color: var(--button-text-color);
    text-decoration: none;
}

.bible-content .placeholder {
    color: #666;
    text-align: center;
    font-style: italic;
    padding: 50px 0;
}

/* Specific styles for new elements from last update */
.introduction-text {
    font-style: italic;
    margin-bottom: 20px;
    padding: 15px;
    background-color: #f9f9f9;
    border-left: 5px solid #4CAF50;
    color: #555;
    white-space: pre-wrap;
}

.introduction-link {
    color: #007bff;
    text-decoration: underline;
    cursor: pointer;
    font-weight: bold;
}
.introduction-link:hover {
    color: #0056b3;
}


h2, h3 {
    color: #2c3e50;
	font-size: 1.0em;
    text-align: center;
    margin-top: 1px;
    margin-bottom: 1px;
}

.subheading {
	font-size: var(--bible-subheading-font-size);
    font-size: 0.9em;
    font-weight: bold;
    color: var(--subheading-text-color);  
    margin-top: 0.1em;
    margin-bottom: 0.1em;
    border-bottom: 1px solid var(--subheading-border-color);
    padding-bottom: 5px;
    text-align: left;
}

.footnote-marker {
    vertical-align: super;
    font-size: 0.8em;
    color: #888;
    margin-left: 3px;
    cursor: help;
}

.footnote-text {
    font-size: 0.85em;
    color: #666;
    display: none;
    position: absolute;
    background-color: #fffacd;
    border: 1px solid #daa520;
    padding: 5px 10px;
    border-radius: 4px;
    z-index: 10;
    max-width: 300px;
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
}

.footnote-marker:hover + .footnote-text {
    display: inline;
}

.hidden {
    display: none !important;
}

footer {
    text-align: center;
    color: #666;
	max-height: 30px;
    font-size: 0.9em;
    background: var(--panel-bg-color);
    border-top: 1px solid #ccc;
    flex-shrink: 0;
}
footer p{
	margin-top: 2px;
}

/* Modal styles (general) */
.modal {
    position: fixed;
    z-index: 1000; /* Ensure it's above most other content */
    left: 0;
    top: 0;
    width: 100%;
    height: 95%;
    background-color: rgba(0,0,0,0.5); /* Slightly darker overlay */
    display: flex; /* Keep this for centering */
    justify-content: center;
    align-items: center;
    padding: 15px; /* Padding for small screens so modal doesn't touch edges */
    box-sizing: border-box;
}

.modal-content {
    background-color: var(--modal-content-bg-color);
    padding: 20px 25px; /* More padding */
    border: 1px solid var(--modal-border-color);
    width: 100%; /* Full width up to max-width */
    max-width: 550px; /* Slightly narrower for a more focused feel */
    border-radius: 8px;
    box-shadow: var(--modal-shadow);
    position: relative; /* For absolute positioning of close button */
    display: flex;
    flex-direction: column;
    max-height: 90vh; /* Max height relative to viewport */
}

#commentaryModalTitle { /* This contains the title and the tabs */
    margin-top: 0;
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: 1px solid var(--modal-border-color);
    flex-shrink: 0; /* Prevent title/tabs from shrinking if text is long */
    /* Ensure title and tabs within it don't cause overflow themselves */
}

#commentaryModalNav { /* The prev/next buttons container */
    text-align:center;
		margin-top: 1px;
    margin-bottom:5px;
    flex-shrink: 0; /* Prevent nav buttons from shrinking */
}

#commentaryModalText {
    flex-grow: 1;         /* Allow this div to take up remaining vertical space */
    overflow-y: auto;     /* <<< ADD THIS: Show scrollbar if content overflows its allotted space */
    min-height: 100px;    /* Optional: give it a minimum height */
    padding-right: 10px;  /* Add some padding if scrollbar is too close to text */
    box-sizing: border-box;
    /* Text styles will be inherited or you can set them: */
    color: var(--main-text-color); /* Or --bible-column-text-color or similar */
    line-height: 1.6;
}

.modal-content h2 { /* Modal titles */
    margin-top: 0;
}

.modal-form-group {
    margin-bottom: 15px;
    text-align: left;
}

.modal-form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.modal-form-group input[type="text"],
.modal-form-group textarea {
    width: calc(100% - 22px); /* Account for padding/border */
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 1rem;
    box-sizing: border-box; /* Include padding/border in width */
}

.modal-form-group textarea {
    min-height: 100px;
    resize: vertical;
}

/* Note Modal Specifics */
#noteModalTitle {
    font-size: 1.1em; /* Larger title */
    font-weight: 600; /* Semi-bold */
    color: var(--modal-title-text-color);
    text-align: center;
    margin-top: 0; /* Already good */
    margin-bottom: 5px; /* More space below title */
    padding-right: 5px; /* Ensure it doesn't overlap with a far-right close button */
}

#noteTextarea {
    width: 100%;
    box-sizing: border-box;
    padding: 12px 15px; /* More padding inside textarea */
    border: 1px solid var(--input-border-color);
    border-radius: 6px; /* Slightly more rounded */
    font-size: var(--font-size-normal, 1rem);
    font-family: var(--font-family-main);
    min-height: 180px; /* Allow for more lines */
    resize: vertical;
    margin-bottom: 25px; /* More space above buttons */
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    transition: border-color 0.2s ease;
}

#noteTextarea:focus {
    outline: none;
    border-color: var(--input-focus-border-color); /* Highlight border on focus */
    box-shadow: 0 0 0 2px var(--accent-color-transparent, rgba(76, 175, 80, 0.2)); /* Optional: subtle glow, define --accent-color-transparent */
}

.modal-actions {
    display: flex; /* Use flexbox for button alignment */
    justify-content: flex-end; /* Align buttons to the right */
    gap: 10px; /* Space between buttons */
    margin-top: 0; /* Removed margin-top as textarea now has margin-bottom */
}

.modal-actions button {
    padding: 10px 20px; /* More padding for better click targets */
    border: 1px solid transparent; /* Base border for all buttons */
    border-radius: 5px; /* Consistent border radius */
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 500; /* Medium weight for button text */
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, opacity 0.2s ease;
    line-height: 1.5; /* Ensure text vertical alignment */
}

#saveNoteBtn, #saveBookmarkBtn {
    background-color: var(--accent-color);
    color: var(--accent-text-color);
    border-color: var(--accent-color);
}
#saveNoteBtn:hover, #saveBookmarkBtn:hover {
    opacity: 0.85;
}

#cancelNoteBtn, #cancelBookmarkBtn {
    background-color: #ddd;
    color: #333;
}
#cancelNoteBtn:hover, #cancelBookmarkBtn:hover {
    background-color: #ccc;
}


.delete-btn {
    background-color: #dc3545;
    color: white;
}
.delete-btn:hover {
    background-color: #c82333;
}
/* Delete Note Button (Destructive Action) */
#deleteNoteBtn.delete-btn { /* Ensure selector specificity if needed */
    background-color: var(--delete-button-bg-color);
    color: var(--delete-button-text-color);
    border-color: var(--delete-button-bg-color);
}
#deleteNoteBtn.delete-btn:hover {
    opacity: 0.85; /* Or use a theme variable */
}

/* Cancel Note Button (Secondary Action) */
#cancelNoteBtn {
    background-color: var(--button-secondary-bg-color);
    color: var(--button-secondary-text-color);
    border: 1px solid var(--button-secondary-border-color);
}
#cancelNoteBtn:hover {
    background-color: var(--button-secondary-hover-bg-color);
}

.close-button {
    color: var(--main-text-color); /* Use main text color, but can be themed */
    position: absolute;
    top: 15px; /* Adjust position */
    right: 20px;
    font-size: 26px; /* Slightly adjusted */
    font-weight: bold;
    cursor: pointer;
    line-height: 1;
    padding: 0 5px;
    opacity: 0.7;
}

.close-button:hover,
.close-button:focus {
    color: var(--link-hover-color); /* Or a stronger interactive color */
    opacity: 1;
    text-decoration: none;
}

/* User Data Panel Tabs */
.user-data-tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
    border-bottom: 1px solid #eee;
}

.tab-button {
    background-color: #f0f0f0;
    border: 1px solid #ddd;
    border-bottom: none;
    padding: 10px 15px;
    cursor: pointer;
    font-size: 1rem;
    border-radius: 5px 5px 0 0;
    transition: background-color 0.2s ease;
    margin: 0 2px;
}

.tab-button:hover:not(.active) {
    background-color: #e0e0e0;
}

.tab-button.active {
    background-color: #4CAF50;
    color: white;
    font-weight: bold;
    border-color: #4CAF50;
}

.tab-content {
    padding-top: 10px;
    /* Removed margin-top to avoid double spacing with .panel padding */
}

.user-data-list {
    list-style: none;
    padding: 0;
    margin: 15px 0;
    max-height: 350px; /* Make lists scrollable */
    overflow-y: auto;
    border: 1px solid #f0f0f0;
    border-radius: 4px;
    background-color: #fcfcfc;
}

.user-data-list li {
    padding: 10px 15px;
    border-bottom: 1px solid #f0f0f0;
    cursor: pointer;
    transition: background-color 0.2s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.user-data-list li:last-child {
    border-bottom: none;
}

.user-data-list li:hover {
    background-color: #e6f7ff;
}

.user-data-list li .meta {
    font-size: 0.8em;
    color: #666;
    margin-left: 10px;
    white-space: nowrap;
}

.user-data-list li .category-tag {
    background-color: #f0f0f0;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.7em;
    font-weight: bold;
    color: #555;
    margin-left: 10px;
}

/* Highlighted verse styling */
.highlight-yellow { background-color: var(--highlight-yellow); } 
.highlight-green { background-color: var(--highlight-green); }  
.highlight-blue { background-color: var(--highlight-blue); }  
.highlight-pink { background-color: var(--highlight-pink); }  
.highlight-orange { background-color: var(--highlight-orange); }
.highlight-purple { background-color: var(--highlight-purple); }

.partial-note-anchor {
    /* Optional: Add a subtle visual cue to the text itself if you want it to look different */
    /* background-color: #f0f8ff; */ /* e.g., very light alice blue background */
    border-bottom: 1px dotted #007bff; /* e.g., dotted underline for the text */
    cursor: pointer; /* Indicates the wrapped text (and icon) is clickable */
    /* white-space: nowrap; /* May cause layout issues, use if icon wraps undesirably */
}

/* New distinct icon for partial notes */
.partial-note-icon.fa-map-pin {
    color: #E91E63; 
    font-size: 0.75em; 
    margin-left: 3px; 
    vertical-align: super; 
}

/* Existing style for whole-verse note indicators (ensure it's different) */
.note-indicator.fa-sticky-note {
    color: #28a745; 
   
}

/* Note/Bookmark icons next to verse number */
.verse-indicator {
    font-size: 0.75em;
    margin-left: 5px;
    color: #28a745; /* Green for notes */
    cursor: pointer;
    transition: color 0.2s ease;
}
.verse-indicator.bookmark {
    color: #007bff; /* Blue for bookmarks */
}
.verse-indicator:hover {
    color: #0056b3;
}

.verse-actions {
    margin-left: 10px;
    display: inline-flex;
    gap: 8px;
    vertical-align: middle;
}

.verse-paragraph .verse-indicator {
    cursor: pointer;
    opacity: 0.5;
    transition: opacity 0.2s ease;
}

.verse-paragraph .verse-indicator:hover {
    opacity: 1;
}

.verse-action-popup {
  position: absolute;
  display: flex;
  gap: 12px;
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 6px 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  z-index: 10000;
}
.verse-action-popup.hidden {
  display: none;
}
.verse-action-popup .action-icon {
  cursor: pointer;
  font-size: 1.1em;
  color: #444;
}
.verse-action-popup .action-icon:hover {
  color: #007BFF;
}

.commentary-tabs {
  display: flex;
  gap: 6px;
  justify-content: center;
  margin-top: 10px;
}
.commentary-tab {
  padding: 4px 10px;
  background: #eee;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
.commentary-tab.active {
  background: #007bff;
  color: white;
  font-weight: bold;
}

/* Highlight Picker */
.highlight-picker {
    position: absolute;
    background-color: white;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    padding: 5px;
    display: flex;
    gap: 5px;
    z-index: 100; /* Above content, below modals */
}

.partial-highlight {
   /* background-color: #fdffb6; */
    border-radius: 4px;
    padding: 0 2px;
}

.color-swatch {
    width: 25px;
    height: 25px;
    border-radius: 50%;
    cursor: pointer;
    border: 1px solid #eee;
    box-shadow: inset 0 0 3px rgba(0,0,0,0.2);
    transition: transform 0.1s ease, box-shadow 0.1s ease;
    display: flex;
    justify-content: center;
    align-items: center;
}

.color-swatch:hover {
    transform: scale(1.1);
    box-shadow: 0 0 5px rgba(0,0,0,0.3);
}

.color-swatch.clear {
    background-color: #f0f0f0;
    border: 1px dashed #aaa;
    color: #666;
    font-size: 1.2em;
}
.color-swatch.clear:hover {
    background-color: #e0e0e0;
    color: #333;
}
.selection-modal-content {
    background-color: var(--modal-content-bg-color);
    color: var(--main-text-color); /* Default text color for content inside */
    padding: 20px 25px 25px 25px; /* Balanced padding */
    border-radius: 8px;
    box-shadow: var(--modal-shadow, 0 6px 18px rgba(0,0,0,0.25)); /* More defined shadow */
    width: 100%;
    max-width: 380px; /* Adjust max-width as needed */
    position: relative;
    display: flex;
    flex-direction: column;
    border: 1px solid var(--modal-border-color);
}
.selection-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--modal-border-color);
}

.selection-modal-header h3 {
    margin: 0;
    font-size: 1.2rem;
    font-weight: 600; /* Semi-bold */
    color: var(--modal-title-text-color); /* Ensure this uses themed title color */
}
.close-selection-modal-btn { /* The '' button */
    background: none;
    border: none;
    font-size: 1.6rem;
    color: var(--main-text-color);
    opacity: 0.6;
    cursor: pointer;
    padding: 0 4px; /* Slight padding for click area */
    line-height: 1;
}
.close-selection-modal-btn:hover {
    opacity: 1;
    color: var(--accent-color); /* Or a specific close-hover color */
}
/* --- Bible Version Selection Specifics --- */
.bible-version-choice {
    margin-bottom: 10px;
}
.bible-version-choice label {
    display: flex; /* Align label text and current version span */
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 8px;
    font-weight: 500;
    font-size: 0.95rem;
    color: var(--main-text-color);
}
.bible-version-choice label span#currentPopupPrimaryVersion,
.bible-version-choice label span#currentPopupSecondaryVersion {
    font-weight: normal;
    font-style: italic;
    font-size: 0.8em;
    color: var(--main-text-color); /* Or a muted version */
    opacity: 0.7;
}

.popup-select { /* <select> elements in Bible version popup */
    width: 100%;
    padding: 10px 12px;
    border: 1px solid var(--input-border-color);
    border-radius: 5px;
    background-color: var(--input-bg-color);
    color: var(--input-text-color);
    font-size: 0.95rem;
    box-sizing: border-box;
    /* Consider basic custom dropdown arrow if desired, or leave as native */
}
.popup-select:focus {
    outline: none;
    border-color: var(--input-focus-border-color);
    box-shadow: 0 0 0 2px var(--accent-color-transparent, rgba(0, 123, 255, 0.2)); /* Use accent color for focus glow */
}

/* --- Commentary & Theme Item Lists (Buttons) --- */
.popup-item-list {
    display: flex;
    flex-direction: column;
    gap: 8px; /* Space between list items */
    max-height: 300px; /* Max height before scrolling */
    overflow-y: auto;
    margin-bottom: 15px; /* Space before any action button below list */
    padding-right: 5px; /* Give scrollbar some space */
}

.popup-item-list button.popup-list-item,
.popup-item-list button.theme-option-button {
    display: block;
    width: 100%;
    text-align: left;
    padding: 10px 12px; /* Good padding */
    background-color: var(--input-bg-color); /* Use a subtle background, consistent with inputs */
    color: var(--main-text-color);
    border: 1px solid var(--input-border-color);
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 400; /* Normal weight for items */
    transition: background-color 0.15s ease, border-color 0.15s ease, color 0.15s ease;
}

.popup-item-list button.popup-list-item:hover,
.popup-item-list button.theme-option-button:hover {
    background-color: var(--subtle-hover-bg-color, var(--main-bg-color)); /* Define --subtle-hover-bg-color or use main bg */
    border-color: var(--accent-color); /* Accent border on hover */
    color: var(--accent-color); /* Accent text on hover */
}

.popup-item-list button.popup-list-item.selected-item,
.popup-item-list button.theme-option-button.selected-item {
    background-color: var(--accent-color);
    color: var(--accent-text-color);
    font-weight: 600; /* Bolder for selected item */
    border-color: var(--accent-color);
}

/* Optional: An "Apply" button if needed for Bible Version Modal */
.selection-modal-content .modal-action-button {
    display: block;
    width: 100%;
    padding: 10px 15px;
    background-color: var(--accent-color);
    color: var(--accent-text-color);
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    margin-top: 10px; /* Space above button if list is present */
    text-align: center;
}
.selection-modal-content .modal-action-button:hover {
    opacity: 0.85;
}

/* --- Sliding Menu --- */
.slide-menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* Dimming overlay */
    z-index: 1090; /* Below menu, above other content */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0s linear 0.3s;
}
.slide-menu-overlay:not(.hidden) {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease, visibility 0s linear 0s;
}

.slide-menu {
    position: fixed;
    top: 0;
    left: -300px; /* Start off-screen (adjust width as needed) */
    width: 280px;  /* Width of the menu */
    max-width: 80%; /* Max width for smaller screens */
    height: 100%;
    background-color: var(--sidebar-bg-color, #34495e); /* Use sidebar theme color */
    color: var(--sidebar-text-color, #fff);
    box-shadow: 3px 0 10px rgba(0, 0, 0, 0.2);
    z-index: 1100; /* Above overlay */
    display: flex;
    flex-direction: column;
    transition: left 0.3s ease-in-out;
}
.slide-menu:not(.hidden) { /* Or use a class like .open */
    left: 0; /* Slide in */
}

.slide-menu-header {
    display: flex;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid var(--sidebar-border-color, rgba(255,255,255,0.1));
    flex-shrink: 0;
}
.menu-title-icon {
    font-size: 1.5em;
    margin-right: 10px;
}
.menu-title-text {
    font-size: 1.2em;
    font-weight: bold;
    flex-grow: 1;
}
.menu-close-btn { /* Style for close button inside menu */
    color: var(--sidebar-text-color); /* Ensure it's visible on menu background */
    font-size: 1.5em; /* Match other close buttons */
}
.menu-close-btn:hover {
    background-color: var(--sidebar-hover-bg-color, rgba(255,255,255,0.1));
}


ul.slide-menu-items {
    list-style: none;
    padding: 0;
    margin: 0;
    flex-grow: 1;
    overflow-y: auto; /* If many menu items */
}
.slide-menu-items li button {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 15px 20px;
    background-color: transparent;
    border: none;
    border-bottom: 1px solid var(--sidebar-border-color, rgba(255,255,255,0.1));
    color: var(--sidebar-text-color);
    text-align: left;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.2s ease;
}
.slide-menu-items li:last-child button {
    border-bottom: none;
}
.slide-menu-items li button:hover {
    background-color: var(--sidebar-hover-bg-color, #4a6582);
}
.menu-item-icon {
    font-size: 1.1em;
    margin-right: 15px;
    width: 20px; /* For alignment */
    text-align: center;
}
.hidden-checkbox {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
    margin: 0;
    padding: 0;
    border: none;
    overflow: hidden;
}

.slide-menu-footer {
    padding: 15px 20px;
    text-align: center;
    font-size: 0.85em;
    border-top: 1px solid var(--sidebar-border-color, rgba(255,255,255,0.1));
    color: var(--sidebar-text-color);
    opacity: 0.7;
    flex-shrink: 0;
}
#hamburgerMenuBtn {
    /* font-size: 1.2em; /* Slightly larger if desired */
    margin: 10px 5px; 
}

.active-version-name-display {
    font-size: 0.65rem;
    color: var(--top-bar-text-color);
    opacity: 0.8;
    margin-left: 1px; /* Space from the Bible icon */
    margin-right: 2px;
    padding: 2px 2px;
    background-color: rgba(0,0,0,0.1);
    border-radius: 3px;
    white-space: nowrap;
    display: none; /* Hide by default, JS will show them */
}

#activePrimaryVersionNameDisplay:not(:empty) { 
    /* display: inline; /* JS handles this */
}

/* Show secondary and its preceding slash ONLY if it has content AND primary has content */
#activeSecondaryVersionNameDisplay:not(:empty) {
    /* display: inline; /* JS handles this */
}
#activePrimaryVersionNameDisplay:not(:empty) + #activeSecondaryVersionNameDisplay:not(:empty):before {
    content: "/";
    margin-right: 3px;
    margin-left: -2px; /* Adjust spacing around slash */
    opacity: 0.7;
}
.column-title.hidden { /* Add this if you don't have a general .hidden already */
    display: none !important;
}

.bible-content p { /* This typically targets your .verse-paragraph elements */
    /* margin-bottom: 0.5em; /* Original default or your previous setting */
    margin-top: 0.15em;    /* Minimal top margin for slight separation */
    margin-bottom: 0.15em; /* Minimal bottom margin */
    padding-top: 0;
    padding-bottom: 0;
    line-height: 1.5;     /* Tighter line height. Adjust between 1.3 to 1.5 for readability. */
                            /* Your original body line-height is 1.6 */
    /* Other styles like text color should be inherited or use CSS variables */
}

.view-mode-toggle-container {
    margin-top: 5px;
	margin-bottom: 5px;
    padding-top: 10px;
	padding-bottom: 10px;
    border-top: 1px solid var(--panel-border-color); /* Separator */
	border-bottom: 1px solid var(--panel-border-color);
}

.view-mode-toggle-container label {
    display: flex;
    align-items: center;
    cursor: pointer;
    font-size: 0.95rem;
    color: var(--main-text-color);
    user-select: none; /* Prevent text from being selected */
}

.view-mode-toggle-container input[type="checkbox"] {
    margin-right: 10px;
    /* Optional: Style the checkbox itself */
    width: 16px;
    height: 16px;
    cursor: pointer;
}
/* --- START: reader SECTION STYLES --- */
#app-container.reader-active #top-bar {
    display: none;
}

/* This rule removes the extra side padding when the reader panel is active */
#app-container.reader-active #reader-view {
    padding: 0 !important;
}

#content-reader-panel {
    background-color: var(--main-bg-color);
    padding: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

#reader-top-bar {
    display: flex;
    flex-direction: column; /* This creates the two rows */
    background-color: var(--sidebar-bg-color);
    color: var(--sidebar-text-color);
    padding: 8px 10px;
    gap: 8px; /* Space between the two rows */
    flex-shrink: 0;
}

/* Row 1: Main Controls */
.reader-main-controls {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
}

#reader-search-box {
    flex-grow: 1; /* Makes search box fill the available middle space */
    min-width: 50px; /* Allows it to shrink on very small screens */
	padding: 8px 12px;
}

/* Row 2: Navigation */
.reader-song-navigation {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-height: 34px; /* Gives the bar a consistent height */
    background-color: rgba(0,0,0,0.15);
    border-radius: 5px;
    padding: 0 10px;
}

#reader-list-title {
    font-weight: bold;
    font-size: 1.1rem;
}

#reader-item-nav-group {
	box-sizing: border-box;
    display: flex;
    align-items: center;
    justify-content: space-between; /* This spaces out the Back, Title, and Next buttons */
    width: 100%;
    gap: 10px;
	padding: 10px;
}

#item-title-display {
    font-weight: bold;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* This will ensure long titles get "..." and don't overflow */
    flex-grow: 1; /* Allow title to take up space but still get truncated */
    min-width: 0; /* The critical fix for flexbox truncation */
}

#reader-item-nav-group .nav-btn {
    flex-shrink: 0; /* This guarantees the Back, Prev, and Next buttons are always visible */
}

/* Content Area */
#reader-content-area {
	border: 5px solid var(--bible-column-border-color);
    padding: 0;
    overflow-y: auto;
    flex-grow: 1;
}

.hymn-list-item {
    padding: 12px 15px;
    border-bottom: 1px solid var(--panel-border-color);
    cursor: pointer;
}

.hymn-list-item:hover {
    background-color: var(--main-bg-color);
}

.hymn-content {
	border: 1px solid var(--bible-column-border-color);
	border-radius: 5px;
    box-sizing: border-box;
	background-color: var(--bible-column-bg-color);
	color: var(--bible-column-text-color);
    width: 100%;
    height: 100%;
    margin: 5px; /* Center the content on larger screens */
    padding: 15px; /* Add padding here for the text container */
	overflow-y: auto;
}

/*------------------- MOBILE VIEW START HERE ------------------- */

/* Responsive adjustments */
@media (max-width: 768px) {
#top-bar {
    flex-direction: row;    /* Keep groups in a row */
    flex-wrap: nowrap;      /* PREVENT groups from wrapping to new line */
    justify-content: space-between;/* Space out the main groups */
    align-items: center;    /* Vertically align items in the bar */
    padding: 0;       /* <<< MINIMAL top/bottom and side padding for the entire bar */
    height: auto;           /* Let content define height, but will be constrained by items */
    gap: 2px;      
	width: 100%;
}
footer {
	display: none;
}
.top-group {
	display:flex;
    width: auto;            /* Group takes its content's width */
    margin-bottom: 0;
    justify-content: center;
    align-items: center;
    flex-shrink: 1;           /* Allow groups to shrink */
    flex-grow: 1;           /* Groups don't expand beyond content unless specified */
    gap: 2px;               /* <<< MINIMAL gap between items *within* a group */
}

/* Specific group for Bible icon & Chapter Nav */
#top-bar-group-left {
    display: flex; /* Ensure it's flex if not already */
    align-items: center;
	gap: 5px;
    /* flex-grow: 1; /* Remove or reduce grow, let content dictate size initially */
    /* min-width: auto; /* Allow to be more compact */
}


/* Group 2: Remaining Tools & Settings Icons */
#top-bar-group-right {
    display: flex;
	align-items: center;
	gap: 5px;
}
    #top-bar-group-right::-webkit-scrollbar { /* Chrome, Safari, Opera */
        display: none;
    }
    /* Hide the original select dropdowns if they were not already removed by JS logic changes */
    #primaryVersionSelect, #secondaryVersionSelect, #commentarySelect, #themeSelect {
        display: none !important;
    }
    /* Hiding the text part of the multi-commentary toggle label if you added the span */
    .top-group .multi-commentary-label-text {
        display: none;
    }
    /* Hiding the "Theme:" label if it's a separate label element */
    label[for="themeSelect"] {
        display: none;
    }

    .top-bar-icon-btn {
        background-color: transparent !important; /* Remove buttony background */
        border: none !important;
        padding: 2px; /* Minimal padding around icon */
        margin: 1px; /* Minimal margin */
        font-size: 1.2em; /* Adjust icon size as needed */
        color: var(--top-bar-text-color); /* Ensure icon color is from theme */

    }
    .top-bar-icon-btn:hover {
        background-color: var(--top-bar-button-hover-bg-color, rgba(255,255,255,0.15)) !important; /* Subtle hover */
    }
/* Specific styling for the Bible Version popup trigger with indicators */
#bibleVersionPopupBtn {
    padding: 1px 1px; /* Base padding */
    padding-right: 1px; /* Extra space on the right if indicators are absolutely positioned there */
}

#bibleVersionPopupBtn .version-indicator {
    /* Your existing styles for indicators are likely fine, just ensure they fit with smaller button */
    font-size: 0.5em; /* Even smaller */
    width: 10px;
    height: 10px;
    /* Adjust top/right if needed */
}
#bibleVersionPopupBtn .version-indicator.primary { top: 1px; right: 6px; }
#bibleVersionPopupBtn .version-indicator.secondary { bottom: 1px; right: -2px; }


/*---------- SEARCH ---------- */
#search-panel {
    /* display: flex; flex-direction: column; /* This is already set by the .panel class, which is good. */
    padding: 10px 55px;
    gap: 10px; /* Add a gap between child elements (controls, status, results, close button) */
}
.search-controls {
    display: flex;
    flex-wrap: wrap; /* Allow controls to wrap on narrow screens */
    gap: 5px;
    align-items: center;
    padding-bottom: 3px;
    border-bottom: 1px solid var(--panel-border-color); /* Add a separator */
    flex-shrink: 0; /* <<< KEY: Prevent this container from shrinking */
}
#searchResultsList {
    flex-grow: 1;         /* <<< KEY: Make this container take all available vertical space */
    overflow-y: auto;     /* <<< KEY: Make it scrollable if content overflows */
    min-height: 0;        /* Required for flex-grow and overflow to work correctly */
    background-color: var(--main-bg-color); /* A slightly different background for the scroll area */
    border-radius: 3px;
    padding: 1px;
	font-size: 0.85em;
}

.message {
    margin-top: 1px;
	margin-bottom: 1px;
    padding: 3px;
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
    border-radius: 3px;
    width: 100%;
}
#closeUploadPanelBtn, #closeCommentaryUploadBtn, #closeSearchPanelBtn, #closeUserDataPanelBtn {
    background-color: var(--accent-color);
    margin-top: 1px;
	width: 60px;
	align-items: center;
	padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
	color: var(--accent-text-color);
}
/* Ensure the icon toggle for multi-commentary is also compact */
.icon-toggle-label { /* The <label> that acts as the button */
    cursor: pointer;
    padding: 0;       /* From mobile top-bar styles, adjust as needed */
    display: inline-flex;
    align-items: center;
    justify-content: center; /* Center the icon if label has fixed size */
    border-radius: 4px;
    /* height: 30px; /* From mobile top-bar styles */
    /* width: 30px;  /* From mobile top-bar styles */
    transition: background-color 0.2s ease;
}
.icon-toggle-label:hover {
    background-color: var(--top-bar-button-hover-bg-color, rgba(255, 255, 255, 0.1));
}
.multi-commentary-icon { /* The <i> tag for the icon */
    font-size: 1.1em; /* Or your standard top-bar icon size */
    color: var(--top-bar-text-color); /* Default color */
    transition: color 0.2s ease;
}
#multiCommentaryToggle:checked + .multi-commentary-icon {
    color: var(--accent-color); /* Use your theme's accent color */
    /* Optionally, change the icon itself or add other effects */
    /* e.g., Font Awesome duotone icons can have primary/secondary opacity changes */
}

.chapter-nav-btn { /* Class for #prevChapterBtn and #nextChapterBtn */
    padding: 1px;   /* Reduced padding */
    font-size: 0.85rem; /* Slightly smaller icon if using em-based icon sizing */
    line-height: 1;     /* Ensure icon is vertically centered if it's text-based */
}

/* --- START: reader SECTION STYLES --- */
#app-container.reader-active #top-bar {
    display: none;
}

/* This rule removes the extra side padding when the reader panel is active */
#app-container.reader-active #reader-view {
    padding: 0 !important;
}

#content-reader-panel {
	border: 1px solid var(--bible-column-border-color); 
	box-sizing: border-box;
    background-color: var(--main-bg-color);
	border: 1px;
    padding: 0;
    overflow: hidden;
}

#reader-top-bar {
    display: flex;
    flex-direction: column; /* This creates the two rows */
    background-color: var(--sidebar-bg-color);
    color: var(--sidebar-text-color);
    padding: 8px 10px;
    gap: 8px; /* Space between the two rows */
    flex-shrink: 0;
}

/* Row 1: Main Controls */
.reader-main-controls {
    display: flex;
    align-items: center;
    gap: 6px;
    width: 100%;
}

#reader-search-box {
    flex-grow: 1; /* Makes search box fill the available middle space */
    min-width: 50px; /* Allows it to shrink on very small screens */
	border-radius: 5px;
	padding: 6px 8px;
}

/* Row 2: Navigation */
.reader-song-navigation {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 99%;
    max-height: 30px; /* Gives the bar a consistent height */
    background-color: rgba(0,0,0,0.15);
    border-radius: 5px;
    padding: 0;
}

#reader-list-title {
    font-weight: bold;
    font-size: 1.1rem;
}

#reader-item-nav-group {
    display: flex;
    align-items: center;
    justify-content: space-between; /* This spaces out the Back, Title, and Next buttons */
    width: 100%;
    gap: 10px;
	padding: 10px;
}

#item-title-display {
    font-weight: bold;
	font-size: 0.95rem;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* This will ensure long titles get "..." and don't overflow */
    flex-grow: 1; /* Allow title to take up space but still get truncated */
    min-width: 0; /* The critical fix for flexbox truncation */
}

#reader-item-nav-group .nav-btn {
    flex-shrink: 0; /* This guarantees the Back, Prev, and Next buttons are always visible */
}
#app-container.reader-active #top-bar {
    display: none;
}
/* Content Area */
#reader-content-area {
	border: 5px solid var(--bible-column-border-color); /* Uses the same border as the Bible view */
    background-color: var(--bible-column-bg-color);
	padding: 5px;
    box-sizing: border-box;
    flex-grow: 1;
	overflow-y: auto;
}
.hymn-content h4 {
	padding: 0;
	margin: 0;
}
.hymn-list-item {
    padding: 6px 10px;
    border-bottom: 1px solid var(--panel-border-color);
    cursor: pointer;
}

.hymn-list-item:hover {
    background-color: var(--main-bg-color);
}

.hymn-content {
	border: 1px solid var(--bible-column-border-color);
    width: 100%; /* Makes the box fill the available space */
    max-width: 800px; /* Prevents it from being too wide on desktops */
    margin: 0 auto; /* Centers the box on wider screens */
    overflow-y: auto;
    /* --- The Visual Styling --- */
    background-color: var(--bible-column-bg-color); /* Uses the same background */
    padding: 7px; /* Adds space between the border and the text inside */
    box-shadow: var(--panel-shadow);
}

/* Current Chapter Display (e.g., "Gen 1") */
#currentChapterDisplay {
    font-size: 0.9rem;
    font-weight: 500; /* Normal or slightly bolder */
    padding: 0;   /* <<< MINIMAL padding */
    margin: 0 1px;      /* <<< MINIMAL margin */
    line-height: 1;   /* Adjust for tight vertical fit */
    max-width: 50px;    /* Reduce max-width further if needed */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: center;
    border: none; 
    background-color: transparent;
    color: var(--top-bar-text-color);
}
.chapter-display {
    font-size: 1.2rem;
    font-weight: bold;
    min-width: 65px;
    text-align: center;
}
    #toggleCommentaryUploadBtn, #toggleViewBtn,  #toggleSearchBtn, #toggleFileUploadBtn, #toggleUserDataBtn {
        width: auto;
        flex-grow: 1;
        margin-bottom: 5px;
		flex-wrap: wrap;
		gap: 1px; 
    }
    #main-content-area {
        flex-direction: column;
    }
    #sidebar {
        width: 100%;
        max-height: 200px;
        border-bottom: 1px solid #ccc;
    }
    #sidebar.hidden {
        max-height: 0;
        padding: 0;
    }
    .panel {
        padding: 10px;
    }
    .parallel-container {
        flex-direction: column;
    }
    .bible-column {
        max-height: none;
    }
    .modal-content {
        width: 95%;
        padding: 20px;
    }
    .user-data-tabs {
        flex-wrap: wrap;
    }
    .tab-button {
        flex-grow: 1;
        margin: 2px 0;
    }
	.items-grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); /* Increased min item width for better spacing */
    gap: 10px;
    padding: 10px 0; /* Add some vertical padding */
    margin-top: 10px;
    width: 100%;
    box-sizing: border-box;
}

}

/*////////////////////////////////////////////////////////////////////// */

.selection-modal { /* The outer modal container (backdrop) */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.55); /* Slightly darker backdrop for more focus */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1050;
    padding: 15px; /* So modal doesn't touch screen edges */
    box-sizing: border-box;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.25s ease-out, visibility 0s linear 0.25s; /* Smooth fade */
}
.selection-modal:not(.hidden) {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.25s ease-out, visibility 0s linear 0s;
}
.selection-modal.hidden {
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s ease, visibility 0s linear 0.2s; /* Delay hiding until fade out */
}
.highlight-color-picker {
  position: absolute;
  background: white;
  border: 1px solid #ccc;
  padding: 6px;
  display: flex;
  gap: 8px;
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  z-index: 9999;
}

.highlight-color-picker.hidden {
  display: none;
}

.color-option {
  width: 24px;
  height: 24px;
  border-radius: 4px;
  cursor: pointer;
  border: 2px solid transparent;
}

.color-option:hover {
  border-color: #333;
}

/* Container for the grid of loaded Bibles/Commentaries */

/* Styling for each item (Bible/Commentary) in the grid - "Card" styling */
.grid-list-item {
    display: flex;
    align-items: center;
    background-color: var(--panel-bg-color); /* Uses panel background, consistent with its container */
    border: 1px solid var(--panel-border-color); 
    border-radius: 6px; /* Slightly softer radius */
    padding: 10px;      /* Increased padding for more internal whitespace */
    box-shadow: var(--panel-shadow, 0 1px 3px rgba(0,0,0,0.07)); /* Subtle shadow */
    transition: box-shadow 0.25s ease-in-out, transform 0.25s ease-in-out, border-color 0.25s ease-in-out;
}

.grid-list-item:hover {
    transform: translateY(-2px); /* Subtle lift */
    box-shadow: 0 6px 12px rgba(0,0,0,0.1); /* Slightly more pronounced shadow on hover */
    border-color: var(--accent-color); /* Accent border on hover */
}

.grid-list-item .item-icon {
    font-size: 1.8em; /* Larger icon */
    color: var(--accent-color); 
    margin-right: 15px;
    flex-shrink: 0;
    width: 30px; /* Give icon a fixed width for alignment */
    text-align: center;
}

.grid-list-item .item-name {
    flex-grow: 1;
    font-size: 1em; /* Standard font size */
    font-weight: 500; /* Medium weight for readability */
    color: var(--main-text-color);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    line-height: 1.4; /* Ensure good line height if name ever wraps (though it's nowrap) */
}

.grid-list-item .remove-item-btn {
    background-color: transparent;
    border: none;
    color: var(--main-text-color); /* Muted color for icon initially */
    opacity: 0.6; /* Make it less prominent until hover */
    font-size: 1.1em;
    cursor: pointer;
    padding: 8px; /* Increase click area */
    margin-left: 12px;
    border-radius: 50%;
    width: 36px;  
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease, color 0.2s ease, opacity 0.2s ease;
    flex-shrink: 0;
}

.grid-list-item .remove-item-btn:hover {
    background-color: var(--delete-button-bg-color, rgba(220, 53, 69, 0.1)); /* Use theme delete color, with fallback for hover bg */
    color: var(--delete-button-text-color, #c82333); /* Icon becomes more prominent red */
    opacity: 1;
}

/* Placeholder text styling within the grid container */
.items-grid-container .placeholder {
    grid-column: 1 / -1; 
    text-align: center;
    color: var(--main-text-color); 
    opacity: 0.6; /* Make placeholder less prominent */
    padding: 25px;
    font-style: italic;
    font-size: 0.95em;
}

/* General styling for the modal title H2 element */
.modal-content h2#commentaryModalTitle, 
.modal-content h2#noteModalTitle { /* Apply to other modal titles too */
    font-size: 1.1em; /* Adjust as desired */
    font-weight: 600;
    color: var(--modal-title-text-color); /* <<< USE THEME VARIABLE FOR TEXT */
    text-align: center;
    margin-top: 0;
    margin-bottom: 0; /* Space before commentary tabs/nav */
    padding-bottom: 5px;
    border-bottom: 1px solid var(--modal-border-color);
}

/* Container for the commentary tabs (JS adds this div inside #commentaryModalTitle) */
#commentaryModalTitle .commentary-tabs {
    display: flex;
    flex-wrap: wrap; /* Allow tabs to wrap if many */
    gap: 6px;
    justify-content: center;
    margin-top: 5px; /* Space between verse label and tabs */
}

/* Individual commentary tab buttons */
#commentaryModalTitle .commentary-tab {
    padding: 1px 2px; /* More padding */
    background-color: var(--input-bg-color);    /* <<< USE THEME VARIABLE for background */
    color: var(--main-text-color);           /* <<< USE THEME VARIABLE for text */
    border: 1px solid var(--input-border-color); /* <<< USE THEME VARIABLE for border */
    border-radius: 5px; /* Slightly more rounded */
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500; /* Medium weight */
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

#commentaryModalTitle .commentary-tab:hover {
    background-color: var(--main-bg-color); /* Or a specific hover variable */
    border-color: var(--accent-color); /* Highlight border on hover */
    color: var(--accent-color); /* Change text color on hover for emphasis */
}

#commentaryModalTitle .commentary-tab.active {
    background-color: var(--accent-color);      /* Active tab uses accent color */
    color: var(--accent-text-color);         /* Text color for active tab */
    font-weight: bold;
    border-color: var(--accent-color);         /* Border matches accent */
}
